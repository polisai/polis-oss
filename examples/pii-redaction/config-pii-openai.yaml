server:
  listenParams:
    - address: ":8092"
      protocol: "http" # Use HTTP for local demo simplicity to avoid cert issues in Python

pipelines:
  - id: pii-redaction-openai
    description: "Redacts PII from request bodies and forwards to OpenAI."
    agentId: "*"
    protocol: http
    nodes:
      - id: redact-pii
        type: dlp
        config:
          rules_file: "examples/pii-redaction/dlp_rules.yaml" # Loads from current directory
          deidentify_template: "*****"
          scope: "request"
        on:
          success: egress
          failure: egress # Fail open for this example, or route to error

      - id: egress
        type: egress
        config:
          upstream_url: "https://api.openai.com"
          upstream_mode: "static"
        on:
          success: ""
